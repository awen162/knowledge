# HTTP2

1. 二进制分帧层

在 HTTP 协议内部增加二进制分帧

HTTP 2.0通信的最小单位 帧，包括帧首部、流标识符、优先值和帧净荷等。 

消息：指逻辑上的HTTP消息。一系列数据帧组成了一个完整的消息。

流：连接中的虚拟信道，可承载任意数量的双向数据流。

所有HTTP2.0通信都可以在一个TCP连接上完成，这个连接上面可以承载任意数量的数据流，每个消息以数据流的形式发送，而消息也就是数据流又被拆分成一个或多个数据帧，这些帧可以乱序发送，然后根据帧首部流标识符重组。

2. 多路复用共享连接

HTTP1.1在同一个连接上串行传输，对用一个域名同时只能发起指定数量的连接请求。而HTTP2，在同一个TCP连接上即可并行传输多个HTTP请求。

3. 请求优先级

存在多个资源请求时，可通过指定优先级优先发送指定请求的数据包

4. 服务端推送

HTTP 2.0增加了服务端推送功能，服务端可以根据客户端的请求，提前返回多个响应，推送额外的资源给客户端。

5. 首部压缩

HTTP 1.x每一次通信（请求/响应）都会携带首部信息用于描述资源属性。HTTP 2.0在客户端和服务端之间使用“首部表”来跟踪和存储之前发送的键-值对。首部表在连接过程中始终存在，新增的键-值对会更新到表尾，因此，不需要每次通信都需要再携带首部。 

6. 一个完整的HTTP 2.0通信过程

   1. 基于ALPN的协商过程

    支持HTTP 2.0的浏览器可以在TLS会话层自发完成和服务端的协议协商以确定是否使用HTTP 2.0通信。其原理是TLS 1.2中引入了扩展字段，以允许协议的扩展，其中ALPN协议（Application Layer Protocol Negotiation, 应用层协议协商, 前身是NPN）用于客户端和服务端的协议协商过程。 

    2. HTTP Upgrade
