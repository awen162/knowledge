# 秒杀系统

正常电子商务流程
查询商品 — 创建订单 — 扣减库存 — 更新订单 — 付款 — 卖家发货

秒杀业务的特性
低廉价格、大幅推广、瞬时售空、定时上架、瞬时并发量高

限时秒杀，限制数量

特点：高并发

降低并发数，减少不必要的并发。

尽量将请求拦截在系统上游
读多写少的常用多使用缓存

浏览器层请求拦截
CDN层拦截
服务端访问频率控制
服务端缓存拦截
应用内缓存设计，缓存预热
数据库分库分表应用层分片

实现要点：

* 分离实现&独立部署，避免对原有业务造成影响，独立域名
* 活动开始前需要调整相关网络资源容量，避免带宽瓶颈造成网络拥塞

* 秒杀页面静态化，避免查询商品信息对后端造成冲击
* 静态资源最小化压缩，并配置浏览器缓存，有条件可启用CDN加速。静态资源做好版本化控制。

* 业务逻辑上，秒杀按钮设置倒计时
* 限制单个IP/用户访问频率

* 请求进入排队，将秒杀信息丢入消息队列异步处理，同时订阅处理成功的回执。当消息队列达到一定限度后，返回服务器繁忙等信息提示。

* 数据库层，将所有商品信息及库存预热到Redis中。

防刷：

进行人机交互验证，验证码
IP限制
UID限制

高并发

减少不必要的并发：业务优化，HTTP优化

分层设计：

接入层
服务层
数据层

异步

分布式

水平方向分割

高可用

冗余处理


HTTP优化

协议优化：启用KeepAlive，HTTP2
链接优化：多域名，6个限制
内容优化：最小化压缩，缓存，CDN加速，智能DNS解析

跨域问题
