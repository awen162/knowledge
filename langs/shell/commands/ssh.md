# SSH

相关命令：

scp(1), sftp(1), tun(4), hosts.equiv(5), ssh_config(5)

ssh-add(1), ssh-agent(1), ssh-keygen(1), ssh-keyscan(1), ssh-keysign(8), sshd(8)

## sshd命令

sshd命令是openssh软件套件中的服务器守护进程。

语法：

```sh
sshd (选项)
```

选项：

* -4：强制使用IPv4地址； 
* -6：强制使用IPv6地址； 
* -D：以后台守护进程方式运行服务器； 
* -d：调试模式； 
* -e：将错误发送到标准错误设备，而不是将其发送到系统日志； 
* -f：指定服务器的配置文件； 
* -g：指定客户端登录时的过期时间，如果在此期限内，用户没有正确认证，则服务器断开次客户端的连接

## ssh-keygen

ssh-keygen命令用于为“ssh”生成、管理和转换认证密钥，它支持RSA和DSA两种认证密钥。 

语法 

```sh
ssh-keygen (选项) 
```

选项 

* -b：指定密钥长度； 
* -e：读取openssh的私钥或者公钥文件；
* -C：添加注释； 
* -f：指定用来保存密钥的文件名； 
* -i：读取未加密的ssh-v2兼容的私钥/公钥文件，然后在标准输出设备上显示openssh兼容的私钥/公钥； 
* -l：显示公钥文件的指纹数据； 
* -N：提供一个新密语； 
* -P：提供（旧）密语； 
* -q：静默模式； 
* -t：指定要创建的密钥类型。


## ssh-add

ssh-add命令是把专用密钥添加到ssh-agent的高速缓存中。

语法：

```
ssh-add [-cDdLlXx] [-t life] [file ...] 
ssh-add -s pkcs11 
ssh-add -e pkcs11
```

选项：

* -D：删除ssh-agent中的所有密钥. 
* -d：从ssh-agent中的删除密钥 
* -e pkcs11：删除PKCS#11共享库pkcs1提供的钥匙。 
* -s pkcs11：添加PKCS#11共享库pkcs1提供的钥匙。
* -L：显示ssh-agent中的公钥 
* -l：显示ssh-agent中的密钥 
* -t life：对加载的密钥设置超时时间，超时ssh-agent将自动卸载密钥 
* -X：对ssh-agent进行解锁 
* -x：对ssh-agent进行加锁

示例：

* 1、把专用密钥添加到 ssh-agent 的高速缓存中：

```sh
ssh-add ~/.ssh/id_dsa 
```

* 2、从ssh-agent中删除密钥： 

```sh
ssh-add -d ~/.ssh/id_xxx.pub 
```

* 3、查看ssh-agent中的密钥：

```sh 
ssh-add -l
```

## ssh-keyscan

ssh-keyscan命令是一个收集大量主机公钥的使用工具。 
 
语法

```sh
ssh-keyscan(选项)(参数) 
```

选项
 
* -4：强制使用IPv4地址； 
* -6：强制使用IPv6地址； 
* -f：从指定文件中读取“地址列表/名字列表”； 
* -p：指定连接远程主机的端口； 
* -T：指定连接尝试的超时时间； 
* -t：指定要创建的密钥类型； 
* -v：信息模式，打印调试信息。 

参数

* 主机列表：指定要收集公钥的主机列表。

## ssh

ssh命令是openssh套件中的客户端连接工具，可以给予ssh加密协议实现安全的远程登录服务器。 

语法 

```sh
ssh (选项) (参数) 
```

选项 

* -1：强制使用ssh协议版本1； 
* -2：强制使用ssh协议版本2； 
* -4：强制使用IPv4地址； 
* -6：强制使用IPv6地址； 
* -A：开启认证代理连接转发功能； 
* -a：关闭认证代理连接转发功能； 
* -b：使用本机指定地址作为对应连接的源ip地址； 
* -C：请求压缩所有数据； 
* -F：指定ssh指令的配置文件； 
* -f：后台执行ssh指令； 
* -g：允许远程主机连接主机的转发端口； 
* -i：指定身份文件； 
* -l：指定连接远程服务器登录用户名； 
* -N：不执行远程指令； 
* -o：指定配置选项； 
* -p：指定远程服务器上的端口； 
* -q：静默模式； 
* -X：开启X11转发功能； 
* -x：关闭X11转发功能； 
* -y：开启信任X11转发功能。 

参数 

* 远程主机：指定要连接的远程ssh服务器； 
* 指令：要在远程ssh服务器上执行的指令。
